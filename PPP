To help your team understand the new logic, here is a comprehensive table that includes Positive Cases (where notifications fire) and Negative Cases (where notifications are blocked).
Comprehensive Logic Matrix
| Operation | Logic | Data State | Activity (Trigger) | Result | Simple Explanation |
|---|---|---|---|---|---|
| Create | AND | All Correct | (Initial Insert) | TRUE | New record matches all criteria. |
| Create | OR | Any Correct | (Initial Insert) | TRUE | New record matches at least one criteria. |
| Update | AND | All Correct | At least one changed | TRUE | Positive: Data is right AND part of it was just updated. |
| Update | AND | All Correct | All Static | FALSE | Negative: Data is right, but nothing changed (Spam Protection). |
| Update | AND | Partial Match | One changed | FALSE | Negative: All rules must pass for AND. |
| Update | OR | Matches | Is changed | TRUE | Positive: One of the rules was met via an update. |
| Update | OR | Matches | Is Static | FALSE* | Negative: For equalsOrChangedTo, we ignore static values to prevent loops. |
*Note: Standard operators in OR (like eqDate) might still return TRUE on static matches if that matches your existing legacy behavior, but the new equalsOrChangedTo will correctly return FALSE here.
Understanding the "Static Value" Negative Case
The "Static Value" case is the most important fix for your AND conditions.
 * The Scenario: You have a rule for operationCode6 and transferRequestStatus. Both are already correct in the database.
 * The Event: An unrelated field, like a "User Remarks" field, is updated.
 * The Old Problem: The system would see that both conditions are "Correct" and send a notification again.
 * The New Logic (Negative Case): * Pass 1: Identifies that the values match (Matches = True).
   * Pass 1: Identifies that the specific fields were not updated (Changed = False).
   * Pass 2: The AND logic sees atLeastOneChange is False.
   * Result: The notification is blocked. This prevents the same notification from being sent every time the record is saved.
Quick Team Summary: "What Changed?"
 * AND Conditions are now "State + Trigger": It is no longer enough for the data to be correct; one of the fields in the AND block must have been part of the update to "trigger" the event.
 * Static Data is Protected: If the document is updated but the specific fields in your configuration weren't touched, no notification will fire.
 * Creation is Always a Trigger: We bypass the "Change" check for new records (isCreate), ensuring that the very first time a document matches your rules, the notification goes out.
Would you like me to provide the final, complete code block for EventProcessing.java one last time to ensure all these table cases are perfectly implemented?
