import com.azure.messaging.servicebus.*
import com.azure.messaging.servicebus.models.*

// Get variables from JMeter
String connectionString = vars.get("ConnectionString")
String queueName = vars.get("QueueName")

// Build a unique message per thread
String messageBody = "This is message from thread " + vars.get("__threadNum") + " at " + System.currentTimeMillis()

ServiceBusSenderClient sender = null
try {
    // Build the sender client
    sender = new ServiceBusClientBuilder()
        .connectionString(connectionString)
        .sender()
        .queueName(queueName)
        .buildClient()

    // Send the message
    sender.sendMessage(new ServiceBusMessage(messageBody))

    // Mark JMeter result as successful
    SampleResult.setSuccessful(true)
    SampleResult.setResponseCode("200")
    SampleResult.setResponseMessage("Message sent successfully")
} catch (Exception e) {
    SampleResult.setSuccessful(false)
    SampleResult.setResponseCode("500")
    SampleResult.setResponseMessage("Error: " + e.toString())
    log.error("Failed to send to Service Bus: ", e)
} finally {
    if (sender != null) {
        sender.close()
    }
}

====

Excellent question ğŸ‘ â€” because this is the most important step before you upload to Azure Load Testing.
Youâ€™ll use Maven outside JMeter (not inside it) just to download all the Azure SDK .jar dependencies easily.

Letâ€™s do it step by step ğŸ‘‡

â¸»

ğŸ§© Goal:

Create a small Maven project â†’ download Azure SDK JARs â†’ copy them into JMeter â†’ (or zip for Azure Load Testing).

â¸»

âš™ï¸ Step-by-Step

1ï¸âƒ£ Create a folder

Make a folder anywhere (for example):

C:\JMeterAzureLibs


â¸»

2ï¸âƒ£ Create a Maven project

You can do it manually without an IDE:

Open a command prompt inside that folder and run:

mvn archetype:generate -DgroupId=com.example -DartifactId=azure-deps -DarchetypeArtifactId=maven-archetype-quickstart -DinteractiveMode=false

This will create:

C:\JMeterAzureLibs\azure-deps
   â”œâ”€â”€ pom.xml
   â””â”€â”€ src\


â¸»

3ï¸âƒ£ Edit the pom.xml

Open pom.xml and replace everything inside with this ğŸ‘‡

<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>com.example</groupId>
    <artifactId>azure-deps</artifactId>
    <version>1.0</version>

    <dependencies>
        <!-- Azure Service Bus SDK -->
        <dependency>
            <groupId>com.azure</groupId>
            <artifactId>azure-messaging-servicebus</artifactId>
            <version>7.17.2</version>
        </dependency>

        <!-- Logging (optional but recommended) -->
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-api</artifactId>
            <version>2.0.12</version>
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-simple</artifactId>
            <version>2.0.12</version>
        </dependency>
    </dependencies>
</project>


â¸»

4ï¸âƒ£ Download all dependencies

Run this command inside your azure-deps folder:

mvn dependency:copy-dependencies

This will create:

target/dependency/

Inside, youâ€™ll find all .jar files you need â€” including Azure SDK and its transitive dependencies (reactor, netty, etc.).

â¸»

5ï¸âƒ£ Use these jars in JMeter

You now have two options:

Option A â€“ Local JMeter run
Copy everything from target/dependency/ to:

C:\Softwares\apache-jmeter-5.6.3\lib\ext

Restart JMeter.

Option B â€“ Azure Load Testing
Zip the files:

cd target/dependency
zip -r dependencies.zip *

Then upload dependencies.zip in the Azure Load Test portal (next to your .jmx file).

â¸»

âœ… End Result

Now your JMeter test can:
	â€¢	Import com.azure.messaging.servicebus.*
	â€¢	Run locally and in Azure Load Testing
	â€¢	Work without missing class errors

â¸»

Would you like me to show you exactly which JARs will appear in target/dependency/ (so you can verify itâ€™s complete)?